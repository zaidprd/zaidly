---
// src/pages/index.astro

// 1. Ambil Layout Utama 
import MainLayout from '../layouts/BaseLayout.astro';

// 2. Component (ROOT components/ - PATH SUDAH BENAR)
import Hero from '../components/Hero.astro'; 

// 3. Section Component (components/section/)
import WhoIsZaidly from '../components/section/WhoIsZaidly.astro'; 
import FeaturedCategories from '../components/section/FeaturedCategories.astro';
import CoffeeGearHub from '../components/section/CoffeeGearHub.astro'; 
import LatestPosts from '../components/section/LatestArticles.astro'; 
import CoffeeBeanGuides from '../components/section/CoffeeBeanGuides.astro';

// 4. Ambil data Postingan
import { getCollection } from 'astro:content';

// Ambil semua postingan dan tambahkan pengamanan || []
const allPosts = await getCollection('blog') || []; 

// Filter 8 postingan terbaru
const latestPosts = allPosts
    .sort((a, b) => (b.data.pubDate as Date).getTime() - (a.data.pubDate as Date).getTime())
    .slice(0, 3);

// Filter 4 postingan dengan category: 'gear'
const gearPosts = allPosts.filter(post => post.data.category === 'gear').slice(0, 4);

// Data statis untuk Featured Categories
const featuredCategories = [
    { title: "Gear Guides", description: "Reviews & guides for all brewing equipment.", url: "#", icon: "ri:tools-line" },
    { title: "Bean Types", description: "Explore origins, roasts, and flavor profiles.", url: "#", icon: "ri:seedling-line" },
    { title: "Brew Methods", description: "Master various techniques from pour-over to espresso.", url: "#", icon: "ri:cup-line" },
    { title: "Café Culture", description: "Stories, tips, and trends from the coffee world.", url: "#", icon: "ri:store-line" },
];
---

<MainLayout title="Zaidly - Your Ultimate Coffee Resource">
    
    <Hero 
        title="Best Coffee Gear" 
        subtitle="Upgrade your home coffee routine with expert-reviewed gear, brewing guides, and must-have accessories."
        linkText="Explore Best Coffee Gear"
        linkUrl="/guides" 
    />

    <FeaturedCategories categories={featuredCategories} />

    <WhoIsZaidly 
        title="Who is Zaidly?" 
        subtitle="Zaidly is an independent coffee gear guide built for home brewers who want better coffee without the guesswork. We research, test, and review coffee equipment—from espresso machines and grinders to brewing accessories—so you can choose the right tools with confidence."
        linkText="Read Our Story →"
        linkUrl="/about" 
    />
    
    <CoffeeGearHub posts={gearPosts || []} />
    <CoffeeBeanGuides posts={gearPosts || []}  />
    <LatestPosts posts={latestPosts || []} />

</MainLayout>
---
// src/components/TableOfContents.astro
interface Props {
    headings: { depth: number; text: string; slug: string }[];
}

const { headings } = Astro.props;
const filteredHeadings = headings.filter(h => h.depth > 1 && h.depth < 4);
---

{filteredHeadings.length > 0 && (
  <nav class="toc-container my-8 border-y border-coffee-brown/10 py-5 bg-white/30 backdrop-blur-sm rounded-xl px-4 md:px-6">
    <div class="flex items-center justify-between">
      {/* JUDUL: Pakai font-sans biar minimalis dan ukuran dipaksa kecil */}
      <h2 class="toc-title font-sans font-black uppercase tracking-[0.1em] text-accent-primary">
        Table of Contents
      </h2>
      
      <button 
        id="toc-toggle-btn" 
        class="toc-btn font-sans font-black uppercase tracking-widest border border-coffee-brown/20 px-3 py-1 hover:bg-coffee-dark hover:text-white transition-all rounded bg-white shadow-sm"
      >
        Show
      </button>
    </div>

    <ul id="toc-list-items" class="hidden space-y-3 pt-6 transition-all duration-300">
      {filteredHeadings.map((h, index) => (
        <li class:list={[
          h.depth === 2 ? 'pl-0' : 'pl-6 opacity-80',
          'group relative border-b border-coffee-brown/5 pb-2 last:border-0'
        ]}>
          <a 
            href={`#${h.slug}`} 
            class="toc-link font-sans font-bold uppercase tracking-tight text-coffee-dark hover:text-accent-primary transition-all flex items-start gap-2"
          >
            <span class="text-[9px] text-coffee-brown/40 font-black mt-0.5">
                {String(index + 1).padStart(2, '0')}
            </span>
            <span class="line-clamp-2 md:line-clamp-1">{h.text}</span>
          </a>
        </li>
      ))}
    </ul>
  </nav>
)}

<script is:inline>
  const setupToggle = () => {
    const btn = document.getElementById('toc-toggle-btn');
    const list = document.getElementById('toc-list-items');
    if (btn && list) {
      btn.onclick = () => {
        const isHidden = list.classList.toggle('hidden');
        btn.textContent = isHidden ? 'Show' : 'Hide';
      };
    }
  };
  setupToggle();
  document.addEventListener('astro:page-load', setupToggle);
</script>

<style>
  /* KONTROL UKURAN DI SINI - PASTI BERUBAH */
  .toc-title {
    font-size: 12px !important; /* Kecil & elegan */
    margin: 0 !important;
  }

  .toc-btn {
    font-size: 9px !important; /* Tombol kecil */
    min-width: 65px;
  }

  .toc-link {
    font-size: 11px !important; /* Link isi TOC kecil */
    line-height: 1.4 !important;
  }

  .hidden { display: none !important; }
  ul { list-style: none !important; padding: 0 !important; margin: 0 !important; }
  
  .toc-container {
    background: linear-gradient(to bottom right, rgba(255, 255, 255, 0.7), rgba(245, 245, 240, 0.5));
  }
</style>
---
import { Image } from 'astro:assets';

// 1. Ambil semua gambar produk dari folder assets
const productImages = import.meta.glob<{ default: ImageMetadata }>('../../assets/images/**/*.{jpeg,jpg,png,webp}');

interface GearItem {
    type: string;
    imgKey: string; 
    product: string;
    details: string[];
    amazonUrl: string;
}

const gearPicks: GearItem[] = [
    {
        type: "BEST AUTOMATIC DRIP",
        imgKey: "../../assets/images/Technivorm.webp",
        product: "TECHNIVORM MOCCAMASTER KBGV SELECT",
        details: ["10 cups capacity", "Cone filter", "Glass carafe"],
        amazonUrl: "https://amzn.to/3KEqcAQ" 
    },
    {
        type: "BEST ESPRESSO MACHINE",
        imgKey: "../../assets/images/BrevilleBambinoPlus.webp", // Ganti ke nama file asli jika sudah ada (misal: breville.webp)
        product: "BREVILLE BES840XL INFUSER",
        details: ["Semi-automatic machine", "Manual steam wand", "61 ounces water tank"],
        amazonUrl: "https://amzn.to/44YDnn9"
    },
    {
        type: "BEST POUR-OVER BREWER",
        imgKey: "../../assets/images/Kalita.webp", // Ganti ke nama file asli jika sudah ada (misal: kalita.webp)
        product: "KALITA WAVE",
        details: ["Stainless steel, ceramic, glass, copper", "2 or 4 cups capacity", "Kalita filters"],
        amazonUrl: "https://amzn.to/3Y5sbRC"
    },
];
---

<section class="py-16 bg-cream-latte">
    <div class="container mx-auto max-w-6xl px-4">
        <h2 class="text-3xl font-black text-coffee-dark mb-10 text-center uppercase tracking-wider">
            Our Top 3 Coffee Gear Picks
        </h2>

        <div class="bg-white border border-coffee-brown/10 overflow-hidden shadow-xl">
            {gearPicks.map((item) => (
                <div class="flex flex-col md:flex-row items-center border-b border-coffee-brown/10 last:border-b-0 p-6 sm:p-10 hover:bg-coffee-light/10 transition-colors">
                    
                    <div class="flex-shrink-0 w-full md:w-1/3 text-center mb-8 md:mb-0">
                        <span class="inline-block bg-coffee-dark text-white text-[9px] font-black px-4 py-1.5 mb-6 tracking-[0.2em] uppercase">
                            {item.type}
                        </span>
                        <div class="h-56 flex items-center justify-center overflow-hidden px-4">
                            {productImages[item.imgKey] ? (
                                <Image 
                                    src={productImages[item.imgKey]()} 
                                    alt={item.product}
                                    width={400}
                                    height={400}
                                    class="h-full w-auto object-contain mx-auto transition-transform hover:scale-110 duration-500"
                                />
                            ) : (
                                <div class="bg-gray-50 border-2 border-dashed border-gray-200 w-full h-full flex flex-col items-center justify-center text-gray-400">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="w-8 h-8 mb-2 opacity-20" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
                                    </svg>
                                    <span class="text-[10px] uppercase font-bold tracking-widest">Image Missing</span>
                                </div>
                            )}
                        </div>
                    </div>

                    <div class="flex-grow w-full md:w-5/12 px-0 md:px-12 mb-8 md:mb-0">
                        <h3 class="text-2xl md:text-3xl font-black text-coffee-dark mb-6 leading-[1.1] uppercase tracking-tighter italic">
                            {item.product}
                        </h3>
                        <ul class="space-y-3">
                            {item.details.map(detail => (
                                <li class="flex items-start text-[15px] font-medium text-coffee-brown/80">
                                    <svg class="w-5 h-5 text-accent-primary mr-3 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                                    </svg>
                                    {detail}
                                </li>
                            ))}
                        </ul>
                    </div>

                    <div class="flex-shrink-0 w-full md:w-1/4 flex items-center justify-center border-t md:border-t-0 md:border-l border-gray-100 pt-8 md:pt-0">
                        <a 
                            href={item.amazonUrl} 
                            target="_blank" 
                            rel="noopener noreferrer"
                            class="w-full md:w-auto bg-coffee-dark hover:bg-accent-primary text-white text-[11px] font-black py-5 px-10 tracking-[0.3em] transition-all duration-300 shadow-lg"
                        >
                            CHECK PRICE
                        </a>
                    </div>
                </div>
            ))}
        </div>
    </div>
</section>
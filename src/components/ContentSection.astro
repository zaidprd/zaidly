---
// src/components/ContentSection.astro
import { Image } from 'astro:assets';

interface Props {
    data: any; 
    isFirst?: boolean;
    images?: any;
}

const { data, isFirst = false, images = {} } = Astro.props;

// PENGAMAN: Jika data tidak sengaja kosong, komponen tidak akan merusak seluruh halaman
if (!data || !data.bodyContent) return null;

const paddingTopClass = isFirst ? 'pt-0' : 'pt-20';
---

<section id={data.sectionId} class:list={[paddingTopClass, "container mx-auto max-w-6xl px-4 sm:px-6 lg:px-8"]}>
    <h2 class="text-4xl font-extrabold text-coffee-dark mb-4">{data.sectionTitle}</h2>
    <p class="text-lg text-coffee-brown mb-12">{data.sectionSubtitle}</p>

    {data.bodyContent.map((element: any) => (
        <div class="mb-10">
            {element.title && (
                <p class="font-bold text-coffee-dark mb-4 text-xl">{element.title}</p>
            )}

            {element.type === 'grid' && element.guides && (
                <div class="grid grid-cols-2 md:grid-cols-4 gap-6">
                    {element.guides.map((link: any) => (
                        <a href={link.url} class="group block bg-white rounded-xl overflow-hidden shadow-sm border border-coffee-brown/5">
                            <div class="aspect-square overflow-hidden bg-gray-100">
                                {images[link.imgKey] ? (
                                    <Image 
                                        src={images[link.imgKey]()} 
                                        alt={link.title}
                                        width={400}
                                        height={400}
                                        class="w-full h-full object-cover group-hover:scale-105 transition-all duration-500"
                                    />
                                ) : (
                                    <div class="flex items-center justify-center h-full text-[10px] text-gray-400 p-4 text-center italic">
                                        Image Missing: {link.imgKey?.split('/').pop()}
                                    </div>
                                )}
                            </div>
                            <div class="p-4 text-center">
                                <p class="text-sm font-black text-coffee-dark group-hover:text-accent-primary uppercase tracking-tight">
                                    {link.title}
                                </p>
                            </div>
                        </a>
                    ))}
                </div>
            )}
            
            {/* List Render */}
            {element.type === 'list' && (
                <ul class="space-y-3 ml-2">
                    {element.listItems.map((item: string) => (
                        <li class="flex gap-3 text-coffee-brown">
                            <span class="text-accent-primary">â˜•</span>
                            <span set:html={item} />
                        </li>
                    ))}
                </ul>
            )}
        </div>
    ))}
</section>